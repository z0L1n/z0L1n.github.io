---
layout:     post                    # 使用的布局（不需要改）
title:      复习日记-web基础-SQL               # 标题 
subtitle:   整理一下自己的学习文档
date:       2020-03-22              # 时间
author:     z0L1n                      # 作者
header-img: img/post-bg-2015.jpg    #这篇文章标题背景图片
catalog: true                       # 是否归档
tags:                               #标签
    - web漏洞
---

## 0x00 SQL注入概念

> SQL注入是指web应用对用户输入数据的合法性没有进行判断或者过滤不严，导致攻击者可以在事先定义好的查询语句
的结尾上添加额外的SQL语句，实现非法操作，执行非授权的任意查询，获得相应的信息。

- 一般来说，SQL注入是将web页面的输入参数修改拼接成SQL语句，传递给服务器，进而传给数据库服务器执行数据库命令。
SQL注入语句一般直接参与在sql编译的时候，所以才会导致攻击成功，会导致数据库信息的泄露以及提权，危害性大。

#0x01 常规sql注入：
- 1、寻找注入点：先测试单双引号过滤情况，然后通过and 1=1、and1=2等方法测试，现在一般来说需要这些语句会被waf直接拦截，可以尝试编码绕过，
或者添加过多的括号。
- 2、判断后台数据库类型：如果输入参数导致数据库报错，根据报错信息容易识别数据库类型，一般来说有以下几种常见搭配：`ASP和.NET：Microsoft SQL Server`
`PHP：MySQL、PostgreSQL` `Java：Oracle、MySQL`
- 3、注入类型：
> ①联合注入（union注入）：在闭合查询参数后，直接使用union连接使用的sql语句，完成联合查询，查询数据等等内容，此类sql注入主要是利用
参数拼接SQL语句且对参数安全性没有检验。简单的例子为：`1' union select 1,2,3#`

> ②布尔注入（boolean注入）：该注入主要利用页面返回结果来判断我们的哪些SQL判断条件是成立的。***通常需要爆破数据库的库名，表名，字段名，
需要大量的请求以及响应。

> ③报错注入：程序将报错信息直接显示在了返回的页面上，这个时候我们就能利用报错注入攻击来获取所需要的数据库可信息：个人常用的三个报错注入语句为

>>通过floor报错注入（双查询语句）：`and select 1 from (select count(*),concat(version(),floor(rand(0)*2))x from information_schema.tables group by x)a);`

>>通过extractvalue报错注入：`and extractvalue(1, concat(0x5c, (select table_name from information_schema.tables limit 1)));`

>>通过updatexml报错注入： `and 1=(updatexml(1,concat(0x3a,(select user())),1))`

> ④时间注入：这种情况网页的访问情况和布尔注入相似，利用sleep函数orbenchmark函数使mysql执行时间延长，手工的话一般很少用，个人在sqlmap上才会跑这种注入
经常与条件判断语句结合，`if(exp1,exp2,exp3)`如果exp1成立，返回exp2，否则返回exp3.然后通过查看响应时间来完成条件判断。



